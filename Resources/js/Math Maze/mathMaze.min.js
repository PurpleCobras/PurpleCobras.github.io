function init(){answered=!1,generateEquation(),chooseMaze(),find_Possible_Answers_Coordinates(),last_src=src,img.src=src,requestAnimationFrame(draw)}function chooseMaze(){for(var s=Math.floor(3*Math.random())+1;;){if(1==s?(player_x=136,player_y=368,src="http://i.imgur.com/FmvdAsu.gif",maze_type=1):2==s?(player_x=160,player_y=20,src="http://i.imgur.com/HbEh7Oy.gif",maze_type=2):3==s?(player_x=148,player_y=128,src="http://i.imgur.com/9w2FfaR.gif",maze_type=3):(src="http://i.imgur.com/SYgYZ8L.gif",maze_type=4),src!=last_src)break;s=Math.floor(3*Math.random())+1}}function drawEquation(){ctx.font="25px Verdana",ctx.clearRect(0,0,WIDTH,HEIGHT),ctx.fillText(algebraQuestion[0],0,20),ctx.fillText(algebraQuestion[1],20,20),ctx.fillText(algebraQuestion[2],45,20),ctx.fillText(algebraQuestion[3],65,20),ctx.fillText(algebraQuestion[4],105,20),ctx.fillText(algebraQuestion[5],125,20)}function drawAnswers(){ctx2.font="bold 12px Verdana";var s=possibleAnswers[0].toString(),e=possibleAnswers[1].toString(),r=possibleAnswers[2].toString(),a=possibleAnswers[3].toString();1==maze_type&&(s.length>2?ctx2.fillText(possibleAnswers[0],maze1_x_fraction[possAnswer1-1],maze1_y_fraction[possAnswer1-1]):ctx2.fillText(possibleAnswers[0],maze1_x[possAnswer1-1],maze1_y[possAnswer1-1]),e.length>2?ctx2.fillText(possibleAnswers[1],maze1_x_fraction[possAnswer2-1],maze1_y_fraction[possAnswer2-1]):ctx2.fillText(possibleAnswers[1],maze1_x[possAnswer2-1],maze1_y[possAnswer2-1]),r.length>2?ctx2.fillText(possibleAnswers[2],maze1_x_fraction[possAnswer3-1],maze1_y_fraction[possAnswer3-1]):ctx2.fillText(possibleAnswers[2],maze1_x[possAnswer3-1],maze1_y[possAnswer3-1]),a.length>2?ctx2.fillText(possibleAnswers[3],maze1_x_fraction[possAnswer4-1],maze1_y_fraction[possAnswer4-1]):ctx2.fillText(possibleAnswers[3],maze1_x[possAnswer4-1],maze1_y[possAnswer4-1])),2==maze_type&&(s.length>2?ctx2.fillText(possibleAnswers[0],maze2_x_fraction[possAnswer1-1],maze2_y_fraction[possAnswer1-1]):ctx2.fillText(possibleAnswers[0],maze2_x[possAnswer1-1],maze2_y[possAnswer1-1]),e.length>2?ctx2.fillText(possibleAnswers[1],maze2_x_fraction[possAnswer2-1],maze2_y_fraction[possAnswer2-1]):ctx2.fillText(possibleAnswers[1],maze2_x[possAnswer2-1],maze2_y[possAnswer2-1]),r.length>2?ctx2.fillText(possibleAnswers[2],maze2_x_fraction[possAnswer3-1],maze2_y_fraction[possAnswer3-1]):ctx2.fillText(possibleAnswers[2],maze2_x[possAnswer3-1],maze2_y[possAnswer3-1]),a.length>2?ctx2.fillText(possibleAnswers[3],maze2_x_fraction[possAnswer4-1],maze2_y_fraction[possAnswer4-1]):ctx2.fillText(possibleAnswers[3],maze2_x[possAnswer4-1],maze2_y[possAnswer4-1])),3==maze_type&&(s.length>2?ctx2.fillText(possibleAnswers[0],maze3_x_fraction[possAnswer1-1],maze3_y_fraction[possAnswer1-1]):ctx2.fillText(possibleAnswers[0],maze3_x[possAnswer1-1],maze3_y[possAnswer1-1]),e.length>2?ctx2.fillText(possibleAnswers[1],maze3_x_fraction[possAnswer2-1],maze3_y_fraction[possAnswer2-1]):ctx2.fillText(possibleAnswers[1],maze3_x[possAnswer2-1],maze3_y[possAnswer2-1]),r.length>2?ctx2.fillText(possibleAnswers[2],maze3_x_fraction[possAnswer3-1],maze3_y_fraction[possAnswer3-1]):ctx2.fillText(possibleAnswers[2],maze3_x[possAnswer3-1],maze3_y[possAnswer3-1]),a.length>2?ctx2.fillText(possibleAnswers[3],maze3_x_fraction[possAnswer4-1],maze3_y_fraction[possAnswer4-1]):ctx2.fillText(possibleAnswers[3],maze3_x[possAnswer4-1],maze3_y[possAnswer4-1]))}function draw(){clear(),ctx2.fillStyle="#6b2bab",rect(player_x,player_y,15,15),drawEquation(),ctx2.fillStyle="black",drawAnswers(),ctx2.fillText("Hit:",395,10),ctx2.fillText(hit_Miss[0],440,10),ctx2.fillText("Miss:",395,25),ctx2.fillText(hit_Miss[1],440,25),visEquation.update(hit_Miss),visAnswers.update(possibleAnswers),requestAnimationFrame(draw)}function rect(s,e,r,a){ctx2.beginPath(),ctx2.rect(s,e,r,a),ctx2.closePath(),ctx2.fill()}function clear(){ctx2.clearRect(0,0,WIDTH,HEIGHT),ctx2.drawImage(img,0,0)}function doKeyDown(s){switch(s.keyCode){case 38:player_y-dy>0&&(player_y-=dy,clear(),checkcollision(),1==collision?(player_y+=dy,collision=0):checkForAnswer());break;case 40:HEIGHT>player_y+dy&&(player_y+=dy,clear(),checkcollision(),1==collision?(player_y-=dy,collision=0):checkForAnswer());break;case 37:player_x-dx>0&&(player_x-=dx,clear(),checkcollision(),1==collision?(player_x+=dx,collision=0):checkForAnswer());break;case 39:WIDTH>player_x+dx&&(player_x+=dx,clear(),checkcollision(),1==collision?(player_x-=dx,collision=0):checkForAnswer())}}function checkcollision(){for(var s=ctx2.getImageData(player_x,player_y,15,15),e=s.data,r=0;n=e.length,r<n;r+=4)0==e[r]&&(collision=1)}function checkForAnswer(){var s=possibleAnswers[0].toString(),e=possibleAnswers[1].toString(),r=possibleAnswers[2].toString(),a=possibleAnswers[3].toString();1==maze_type?((player_x<=maze1_x_fraction[possAnswer1-1]&&player_x+16>=maze1_x_fraction[possAnswer1-1]&&player_y<=maze1_y_fraction[possAnswer1-1]&&player_y+16>=maze1_y_fraction[possAnswer1-1]||player_x<=maze1_x[possAnswer1-1]&&player_x+16>=maze1_x[possAnswer1-1]&&player_y<=maze1_y[possAnswer1-1]&&player_y+16>=maze1_y[possAnswer1-1])&&(answer==s?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,possAnswer1=12)),(player_x<=maze1_x_fraction[possAnswer2-1]&&player_x+16>=maze1_x_fraction[possAnswer2-1]&&player_y<=maze1_y_fraction[possAnswer2-1]&&player_y+16>=maze1_y_fraction[possAnswer2-1]||player_x<=maze1_x[possAnswer2-1]&&player_x+16>=maze1_x[possAnswer2-1]&&player_y<=maze1_y[possAnswer2-1]&&player_y+16>=maze1_y[possAnswer2-1])&&(answer==e?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,possAnswer2=12)),(player_x<=maze1_x_fraction[possAnswer3-1]&&player_x+16>=maze1_x_fraction[possAnswer3-1]&&player_y<=maze1_y_fraction[possAnswer3-1]&&player_y+16>=maze1_y_fraction[possAnswer3-1]||player_x<=maze1_x[possAnswer3-1]&&player_x+16>=maze1_x[possAnswer3-1]&&player_y<=maze1_y[possAnswer3-1]&&player_y+16>=maze1_y[possAnswer3-1])&&(answer==r?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,possAnswer3=12)),(player_x<=maze1_x_fraction[possAnswer4-1]&&player_x+16>=maze1_x_fraction[possAnswer4-1]&&player_y<=maze1_y_fraction[possAnswer4-1]&&player_y+16>=maze1_y_fraction[possAnswer4-1]||player_x<=maze1_x[possAnswer4-1]&&player_x+16>=maze1_x[possAnswer4-1]&&player_y<=maze1_y[possAnswer4-1]&&player_y+16>=maze1_y[possAnswer4-1])&&(answer==a?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,possAnswer4=12))):2==maze_type?((player_x<=maze2_x_fraction[possAnswer1-1]&&player_x+15>=maze2_x_fraction[possAnswer1-1]&&player_y<=maze2_y_fraction[possAnswer1-1]&&player_y+15>=maze2_y_fraction[possAnswer1-1]||player_x<=maze2_x[possAnswer1-1]&&player_x+15>=maze2_x[possAnswer1-1]&&player_y<=maze2_y[possAnswer1-1]&&player_y+15>=maze2_y[possAnswer1-1])&&(answer==s?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,possAnswer1=10)),(player_x<=maze2_x_fraction[possAnswer2-1]&&player_x+15>=maze2_x_fraction[possAnswer2-1]&&player_y<=maze2_y_fraction[possAnswer2-1]&&player_y+15>=maze2_y_fraction[possAnswer2-1]||player_x<=maze2_x[possAnswer2-1]&&player_x+15>=maze2_x[possAnswer2-1]&&player_y<=maze2_y[possAnswer2-1]&&player_y+15>=maze2_y[possAnswer2-1])&&(answer==e?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,possAnswer2=10)),(player_x<=maze2_x_fraction[possAnswer3-1]&&player_x+15>=maze2_x_fraction[possAnswer3-1]&&player_y<=maze2_y_fraction[possAnswer3-1]&&player_y+15>=maze2_y_fraction[possAnswer3-1]||player_x<=maze2_x[possAnswer3-1]&&player_x+15>=maze2_x[possAnswer3-1]&&player_y<=maze2_y[possAnswer3-1]&&player_y+15>=maze2_y[possAnswer3-1])&&(answer==r?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,possAnswer3=10)),(player_x<=maze2_x_fraction[possAnswer4-1]&&player_x+15>=maze2_x_fraction[possAnswer4-1]&&player_y<=maze2_y_fraction[possAnswer4-1]&&player_y+15>=maze2_y_fraction[possAnswer4-1]||player_x<=maze2_x[possAnswer4-1]&&player_x+15>=maze2_x[possAnswer4-1]&&player_y<=maze2_y[possAnswer4-1]&&player_y+15>=maze2_y[possAnswer4-1])&&(answer==a?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,possAnswer4=10))):3==maze_type&&((player_x<=maze3_x_fraction[possAnswer1-1]&&player_x+15>=maze3_x_fraction[possAnswer1-1]&&player_y<=maze3_y_fraction[possAnswer1-1]&&player_y+15>=maze3_y_fraction[possAnswer1-1]||player_x<=maze3_x[possAnswer1-1]&&player_x+15>=maze3_x[possAnswer1-1]&&player_y<=maze3_y[possAnswer1-1]&&player_y+15>=maze3_y[possAnswer1-1])&&(answer==s?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,possAnswer1=12)),(player_x<=maze3_x_fraction[possAnswer2-1]&&player_x+15>=maze3_x_fraction[possAnswer2-1]&&player_y<=maze3_y_fraction[possAnswer2-1]&&player_y+15>=maze3_y_fraction[possAnswer2-1]||player_x<=maze3_x[possAnswer2-1]&&player_x+15>=maze3_x[possAnswer2-1]&&player_y<=maze3_y[possAnswer2-1]&&player_y+15>=maze3_y[possAnswer2-1])&&(answer==e?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,possAnswer2=12)),(player_x<=maze3_x_fraction[possAnswer3-1]&&player_x+15>=maze3_x_fraction[possAnswer3-1]&&player_y<=maze3_y_fraction[possAnswer3-1]&&player_y+15>=maze3_y_fraction[possAnswer3-1]||player_x<=maze3_x[possAnswer3-1]&&player_x+15>=maze3_x[possAnswer3-1]&&player_y<=maze3_y[possAnswer3-1]&&player_y+15>=maze3_y[possAnswer3-1])&&(answer==r?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,possAnswer3=12)),(player_x<=maze3_x_fraction[possAnswer4-1]&&player_x+15>=maze3_x_fraction[possAnswer4-1]&&player_y<=maze3_y_fraction[possAnswer4-1]&&player_y+15>=maze3_y_fraction[possAnswer4-1]||player_x<=maze3_x[possAnswer4-1]&&player_x+15>=maze3_x[possAnswer4-1]&&player_y<=maze3_y[possAnswer4-1]&&player_y+15>=maze3_y[possAnswer4-1])&&(answer==a?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,possAnswer4=12)))}function find_Possible_Answers_Coordinates(){if(1==maze_type||3==maze_type){for(possAnswer1=Math.floor(11*Math.random())+1,possAnswer2=Math.floor(11*Math.random())+1,possAnswer3=Math.floor(11*Math.random())+1,possAnswer4=Math.floor(11*Math.random())+1;possAnswer2==possAnswer1;)possAnswer2=Math.floor(11*Math.random())+1;for(;possAnswer3==possAnswer1||possAnswer3==possAnswer2;)possAnswer3=Math.floor(11*Math.random())+1;for(;possAnswer4==possAnswer1||possAnswer4==possAnswer2||possAnswer4==possAnswer3;)possAnswer4=Math.floor(11*Math.random())+1}if(2==maze_type){for(possAnswer1=Math.floor(9*Math.random())+1,possAnswer2=Math.floor(9*Math.random())+1,possAnswer3=Math.floor(9*Math.random())+1,possAnswer4=Math.floor(9*Math.random())+1;possAnswer2==possAnswer1;)possAnswer2=Math.floor(9*Math.random())+1;for(;possAnswer3==possAnswer1||possAnswer3==possAnswer2;)possAnswer3=Math.floor(9*Math.random())+1;for(;possAnswer4==possAnswer1||possAnswer4==possAnswer2||possAnswer4==possAnswer3;)possAnswer4=Math.floor(9*Math.random())+1}}function solve(s,e,r,a){var o=0;return 1==e?(o=a-r,o/=s):(o=a+r,o/=s)}function generateEquation(){var s=random_character(),e=Math.floor(9*Math.random())+1,r=Math.floor(20*Math.random())+1,a=Math.floor(2*Math.random())+1,o=Math.floor(25*Math.random())+1;if(1==a)for(;(o-r)%e!=0;)r=Math.floor(20*Math.random())+1,o=Math.floor(25*Math.random())+1;else for(;(o+r)%e!=0;)r=Math.floor(20*Math.random())+1,o=Math.floor(25*Math.random())+1;answer=solve(e,a,r,o),a=1==a?"+":String.fromCharCode(8211),algebraQuestion[0]=e,algebraQuestion[1]=s,algebraQuestion[2]=a,algebraQuestion[3]=r,algebraQuestion[5]=o;var n=Math.floor(4*Math.random())+1;possibleAnswers[n-1]=answer,fillWrongAnswers(n)}function fillWrongAnswers(s){var e,r,a;for(e=r=a=s;e==s;)e=Math.floor(4*Math.random())+1;for(;r==s||r==e;)r=Math.floor(4*Math.random())+1;for(;a==s||a==e||a==r;)a=Math.floor(4*Math.random())+1;var o,n,t,_=Math.floor(2*Math.random())+1;if(_-1){for(o=Math.floor(9*Math.random())+1,n=Math.floor(9*Math.random())+1;o>n&&9!=o;)n=Math.floor(9*Math.random())+1;9==o&&9!=n&&(n=9),t=o==n?1:new Fraction(o,n),possibleAnswers[e-1]=t.toString()}else t=Math.floor(20*Math.random()),possibleAnswers[e-1]=t;for(t=Math.floor(20*Math.random())+1;t==possibleAnswers[e-1];)t=Math.floor(20*Math.random())+1;for(possibleAnswers[r-1]=t,o=Math.floor(9*Math.random())+1,n=Math.floor(9*Math.random())+1;o>n&&9!=o;)n=Math.floor(9*Math.random())+1;for(9==o&&9!=n&&(n=9);2==o.toString().length&&2==n.toString().length;)o=Math.floor(9*Math.random())+1,n=Math.floor(9*Math.random())+1;t=o==n?1:new Fraction(o,n),possibleAnswers[a-1]=t.toString()}function random_character(){var s="abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";return s.substr(Math.floor(52*Math.random()),1)}var canvas=document.getElementById("function"),maze=document.getElementById("maze"),ctx2=maze.getContext("2d"),WIDTH=482,HEIGHT=482,ctx=canvas.getContext("2d"),src,last_src="_",dx=12,dy=12,player_x=0,player_y=0,player_score=0,answer,possAnswer1,possAnswer2,possAnswer3,possAnswer4,maze_type,maze1_x_fraction=[49,9,9,162,275,276,314,353,125,9,163,WIDTH],maze1_y_fraction=[108,372,220,219,330,145,220,108,68,23,333,HEIGHT],maze1_x=[55,20,20,172,285,287,327,364,133,20,172,WIDTH],maze1_y=[108,372,220,219,330,145,220,108,68,23,333,HEIGHT],maze2_x_fraction=[273,199,311,21,311,170,48,275,199,WIDTH],maze2_y_fraction=[295,375,334,370,110,110,258,35,294,HEIGHT],maze2_x=[284,212,323,21,323,175,64,280,211,WIDTH],maze2_y=[295,375,334,370,110,110,258,35,294,HEIGHT],maze3_x_fraction=[84,52,235,352,352,276,312,161,123,274,316,WIDTH],maze3_y_fraction=[218,105,28,180,258,147,103,175,338,294,374,HEIGHT],maze3_x=[101,52,253,364,364,287,329,173,135,289,316,WIDTH],maze3_y=[218,105,28,180,258,147,103,175,338,294,374,HEIGHT],collision=0,img=new Image;src="http:i.imgur.com/tgg9TNH.gif",img.crossOrigin="anonymous";var hit_Miss=[0,0],possibleAnswers=[1,2,3,4],answered,algebraQuestion=[0,"","",0,"=",0],visEquation=new test;visEquation.structure("array").location("#equationDiv").data(hit_Miss).visualize();var visAnswers=new test;visAnswers.structure("array").location("#answersDiv").data(possibleAnswers).visualize(),init(),window.addEventListener("keydown",doKeyDown,!0);
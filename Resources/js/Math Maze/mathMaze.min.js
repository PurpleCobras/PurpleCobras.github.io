function init(){answer1status=0,answer2status=0,answer3status=0,answer4status=0,XanswerCoords=[],YanswerCoords=[],generateQuestion(),chooseMaze(),last_src=src,img.src=src,requestAnimationFrame(draw)}function rect(s,t,e,r){ctx2.beginPath(),ctx2.rect(s,t,e,r),ctx2.closePath(),ctx2.fill()}function clear(){ctx2.clearRect(0,0,WIDTH,HEIGHT),ctx2.drawImage(img,0,0)}function chooseMaze(){var s=Math.floor(20*Math.random())+1;for(player_x=255,player_y=255;;){if(1==s?(src="http://i.imgur.com/OQgTNuj.gif",maze_type=1):2==s?(src="http://i.imgur.com/flxIDNr.gif",maze_type=2):3==s?(src="http://i.imgur.com/pxR44tj.gif",maze_type=3):4==s?(src="http://i.imgur.com/q5tZz1U.gif",maze_type=4):5==s?(src="http://i.imgur.com/sudypqL.gif",maze_type=5):6==s?(src="http://i.imgur.com/tFBMs81.gif",maze_type=6):7==s?(src="http://i.imgur.com/ItHvT7v.gif",maze_type=7):8==s?(src="http://i.imgur.com/r2oir1h.gif",maze_type=8):9==s?(src="http://i.imgur.com/S3d0Wcr.gif",maze_type=9):10==s?(src="http://i.imgur.com/l7ZfTTL.gif",maze_type=10):11==s?(src="http://i.imgur.com/NGKX5tf.gif",maze_type=11):12==s?(src="http://i.imgur.com/qY1x4yk.gif",maze_type=12):13==s?(src="http://i.imgur.com/9zTyyeJ.gif",maze_type=13):14==s?(src="http://i.imgur.com/2vUXB3g.gif",maze_type=14):15==s?(src="http://i.imgur.com/R8ZYvcP.gif",maze_type=15):16==s?(src="http://i.imgur.com/nzH3QuD.gif",maze_type=16):17==s?(src="http://i.imgur.com/ooj3zxe.gif",maze_type=17):18==s?(src="http://i.imgur.com/NxDleTD.gif",maze_type=18):19==s?(src="http://i.imgur.com/OfqQYtJ.gif",maze_type=19):20==s&&(src="http://i.imgur.com/jk0wHzz.gif",maze_type=20),src!=last_src)break;s=Math.floor(20*Math.random())+1}}function drawEasyEquation(s,t,e,r,a,o,n,i){switch(ctx.clearRect(0,0,WIDTH,HEIGHT),e){case 1:case 2:case 3:case 5:var l;1==e?l="+":2==e?l="-":3==e?l="*":5==e&&(l="/");var c=s.toString(),w=t.toString();c=c.length,w=w.length;var d=14*c,f=14*w,x=252.5-(d+f);ctx.font="20px Lucida Console",ctx.fillText(s,x,30),ctx.fillText(l,x+d,30),ctx.fillText(t,x+d+15,30),ctx.fillText("=",x+d+15+f,30),ctx.fillText(random_character(),x+d+15+f+15,30);break;case 4:if(r){var x=207.5;ctx.font="20px Lucida Console",ctx.fillText(s,x,30),ctx.font="14px Lucida Console",ctx.fillText(t,x+15,20),ctx.font="20px Lucida Console",ctx.fillText("=",x+29,30),ctx.fillText(random_character(),x+45,30)}else{var x=208.5;ctx.font="20px Lucida Console",ctx.fillText(s,x,30),ctx.font="14px Lucida Console",ctx.fillText(random_character(),x+15,20),ctx.font="20px Lucida Console",ctx.fillText("=",x+29,30),ctx.fillText(t,x+44,30)}break;case 6:ctx.font="19px Lucida Console";var c=s.toString();c=c.length;var g=87+14*c,x=252.5-g;ctx.fillText("Find the Least Common Multiple of ",0,30),ctx.fillText(s,390,30),ctx.fillText("and",390+14*c,30),ctx.fillText(t,430+14*c,30);break;case 7:ctx.font="20px Lucida Console";var c=s.toString(),w=t.toString(),p=a.toString();c=c.length,w=w.length,p=p.length;var m=13*c,x=252.5-(m+40+13*w)/2;ctx.fillText(s,x,30),ctx.fillText(random_character(),x+m,30),1==o?ctx.fillText("+",x+m+13,30):ctx.fillText("-",x+m+13,30),ctx.fillText(t,x+m+27,30),ctx.fillText("=",x+m+27+13*w,30),ctx.fillText(a,x+m+40+13*w,30);break;case 8:ctx.font="18px Lucida Console";var c=s.toString();c=c.length;var w=t.toString();w=w.length,ctx.fillText("Find the greatest common factor of ",0,30),ctx.fillText(s,382,30),ctx.fillText("and",382+14*c,30),ctx.fillText(t,382+14*c+40,30);break;case 9:ctx.font="20px Lucida Console";var l,h;l=1==r?"+":"-",h=1==n?"+":"-";var c=s.toString();c=c.length;var p=a.toString();p=p.length;var u=o.toString();u=u.length;var y=i.toString();y=y.length;var A=252.5-(13*c+57+14*p+13*u+13*y)/2;ctx.fillText(s,A,30),ctx.fillText(t,13*c+A,30),ctx.fillText(l,13*c+14+A,30),ctx.fillText(a,13*c+29+A,30),ctx.fillText("=",13*c+29+14*p+A,30),ctx.fillText(o,13*c+43+14*p+A,30),ctx.fillText(h,13*c+43+14*p+13*u+A,30),ctx.fillText(i,13*c+57+14*p+13*u+A,30),ctx.fillText(t,13*c+57+14*p+13*u+13*y+A,30)}}function drawAnswers(){ctx2.font="bold 12px Lucida Console";var s=possibleAnswers[0].toString(),t=possibleAnswers[1].toString(),e=possibleAnswers[2].toString(),r=possibleAnswers[3].toString(),a=0,o=0;1==answer1status?ctx2.fillText(s,600,600):1==s.length?(a=XanswerCoords[possAnswer1-1]+23,o=YanswerCoords[possAnswer1-1]+30,ctx2.fillText(s,a,o)):2==s.length?(a=XanswerCoords[possAnswer1-1]+15,o=YanswerCoords[possAnswer1-1]+30,ctx2.fillText(s,a,o)):(a=XanswerCoords[possAnswer1-1]+10,o=YanswerCoords[possAnswer1-1]+30,ctx2.fillText(s,a,o)),1==answer2status?ctx2.fillText(t,600,600):1==t.length?(a=XanswerCoords[possAnswer2-1]+23,o=YanswerCoords[possAnswer2-1]+30,ctx2.fillText(t,a,o)):2==t.length?(a=XanswerCoords[possAnswer2-1]+15,o=YanswerCoords[possAnswer2-1]+30,ctx2.fillText(t,a,o)):(a=XanswerCoords[possAnswer2-1]+10,o=YanswerCoords[possAnswer2-1]+30,ctx2.fillText(t,a,o)),1==answer3status?ctx2.fillText(e,600,600):1==e.length?(a=XanswerCoords[possAnswer3-1]+23,o=YanswerCoords[possAnswer3-1]+30,ctx2.fillText(e,a,o)):2==e.length?(a=XanswerCoords[possAnswer3-1]+15,o=YanswerCoords[possAnswer3-1]+30,ctx2.fillText(e,a,o)):(a=XanswerCoords[possAnswer3-1]+10,o=YanswerCoords[possAnswer3-1]+30,ctx2.fillText(e,a,o)),1==answer4status?ctx2.fillText(r,600,600):1==r.length?(a=XanswerCoords[possAnswer4-1]+23,o=YanswerCoords[possAnswer4-1]+30,ctx2.fillText(r,a,o)):2==r.length?(a=XanswerCoords[possAnswer4-1]+15,o=YanswerCoords[possAnswer4-1]+30,ctx2.fillText(r,a,o)):(a=XanswerCoords[possAnswer4-1]+10,o=YanswerCoords[possAnswer4-1]+30,ctx2.fillText(r,a,o))}function draw(){img.onload=function(){var s=0,t=0,e=0,s=0;for(ctx2.drawImage(img,0,0),e=45;495>=e;e+=50)for(t=45;495>=t;t+=50){for(var r=ctx2.getImageData(t,e,55,55),a=0;n=r.data.length,a<n;a+=4)0==r.data[a]&&s++;s>=775&&255!==t&&255!==e&&(XanswerCoords.push(t),YanswerCoords.push(e)),s=0}find_Possible_Answers_Coordinates()},clear(),ctx2.fillStyle="#6b2bab",rect(player_x,player_y,35,35),ctx2.fillStyle="black",drawAnswers(),visHitMiss.update(hit_Miss),requestAnimationFrame(draw)}function doKeyDown(s){switch(s.keyCode){case 37:checkcollision(1),clear(),1==collision?collision=0:(player_x-=dx,checkForAnswer());break;case 38:clear(),checkcollision(2),1==collision?collision=0:(player_y-=dy,checkForAnswer());break;case 39:clear(),checkcollision(3),1==collision?collision=0:(player_x+=dx,checkForAnswer());break;case 40:clear(),checkcollision(4),1==collision?collision=0:(player_y+=dy,checkForAnswer())}}function checkcollision(s){var t,e=0,r=0;1==s?(e=player_x-7,r=player_y,t=ctx2.getImageData(e,r,1,1)):2==s?(e=player_x,r=player_y-7,t=ctx2.getImageData(e,r,1,1)):3==s?(e=player_x+42,r=player_y,t=ctx2.getImageData(e,r,1,1)):4==s&&(e=player_x,r=player_y+42,t=ctx2.getImageData(e,r,1,1)),0==t.data[0]&&(collision=1)}function checkForAnswer(){var s=possibleAnswers[0].toString(),t=possibleAnswers[1].toString(),e=possibleAnswers[2].toString(),r=possibleAnswers[3].toString();0==answer1status&&player_x==XanswerCoords[possAnswer1-1]+10&&player_y==YanswerCoords[possAnswer1-1]+10&&(answer==s?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,answer1status=1)),0==answer2status&&player_x==XanswerCoords[possAnswer2-1]+10&&player_y==YanswerCoords[possAnswer2-1]+10&&(answer==t?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,answer2status=1)),0==answer3status&&player_x==XanswerCoords[possAnswer3-1]+10&&player_y==YanswerCoords[possAnswer3-1]+10&&(answer==e?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,answer3status=1)),0==answer4status&&player_x==XanswerCoords[possAnswer4-1]+10&&player_y==YanswerCoords[possAnswer4-1]+10&&(answer==r?(player_score+=1,hit_Miss[0]+=1,init()):(hit_Miss[1]+=1,answer4status=1))}function find_Possible_Answers_Coordinates(){for(possAnswer1=Math.floor(Math.random()*XanswerCoords.length)+1,possAnswer2=Math.floor(Math.random()*XanswerCoords.length)+1,possAnswer3=Math.floor(Math.random()*XanswerCoords.length)+1,possAnswer4=Math.floor(Math.random()*XanswerCoords.length)+1;possAnswer2==possAnswer1;)possAnswer2=Math.floor(Math.random()*XanswerCoords.length)+1;for(;possAnswer3==possAnswer1||possAnswer3==possAnswer2;)possAnswer3=Math.floor(Math.random()*XanswerCoords.length)+1;for(;possAnswer4==possAnswer1||possAnswer4==possAnswer2||possAnswer4==possAnswer3;)possAnswer4=Math.floor(Math.random()*XanswerCoords.length)+1}function solve(s,t,e,r){var a=0;return 1==t?(a=r-e,a/=s):(a=r+e,a/=s)}function generateQuestion(){for(var s=getRandomInt(1,9);s==lastQuestionType;)s=getRandomInt(1,9);switch(lastQuestionType=s,s){case 1:var t=Math.floor(500*Math.random())+1,e=Math.floor(500*Math.random())+1;answer=t+e,drawEasyEquation(t,e,s);break;case 2:var t=Math.floor(500*Math.random())+1,e=Math.floor(500*Math.random())+1;t>=e?(answer=t-e,drawEasyEquation(t,e,s)):(answer=e-t,drawEasyEquation(e,t,s));break;case 3:var t=Math.floor(19*Math.random())+1,e=Math.floor(52*Math.random())+1;answer=t*e,drawEasyEquation(t,e,s);break;case 4:var r=getRandomInt(0,1);if(r=0,1==r){var t=Math.floor(9*Math.random())+1,e=Math.floor(3*Math.random())+1;answer=1;for(var a=0;e>a;++a)answer*=t;drawEasyEquation(t,e,s,1)}else{var t=Math.floor(9*Math.random())+1,e=Math.floor(4*Math.random())+1;answer=e;for(var o=1,a=0;e>a;++a)o*=t;drawEasyEquation(t,o,s,0)}break;case 5:for(var t=Math.floor(500*Math.random())+1,e=Math.floor(500*Math.random())+1;t%e!=0||t==e;)e=Math.floor(500*Math.random())+1;answer=t/e,drawEasyEquation(t,e,s);break;case 6:var t=getRandomInt(1,25),e=getRandomInt(1,25);answer=lcm(t,e),drawEasyEquation(t,e,s);break;case 7:var n=Math.floor(9*Math.random())+1,i=random_character(),l=getRandomInt(1,20),c=getRandomInt(0,1),w=getRandomInt(1,25);if(1==c)for(;(w-l)%n!=0;)l=getRandomInt(1,20),w=getRandomInt(1,25);else for(;(w+l)%n!=0;)w=getRandomInt(1,25),l=getRandomInt(1,20);answer=solve(n,c,l,w),drawEasyEquation(n,l,s,1,w,c);break;case 8:var t=getRandomInt(1,50),e=getRandomInt(1,50);answer=gcd(t,e),drawEasyEquation(t,e,s);break;case 9:var n=getRandomInt(2,15),i=random_character(),l=getRandomInt(1,50),c=getRandomInt(0,1),d=getRandomInt(0,1),w=getRandomInt(1,50),f=getRandomInt(1,15);if(1==d)if(1==c){for(;f>=n;)f=getRandomInt(1,15);for(;(w-l)%(n-f)!=0;)l=getRandomInt(1,50),w=getRandomInt(1,50);answer=solve(n-f,c,l,w)}else{for(;f>=n;)f=getRandomInt(1,15);for(;(w+l)%(n-f)!=0;)l=getRandomInt(1,50),w=getRandomInt(1,50);answer=solve(n-f,c,l,w)}else if(1==c){for(;(w-l)%(n+f)!=0;)l=getRandomInt(1,50),w=getRandomInt(1,50);answer=solve(n+f,c,l,w)}else{for(;(w+l)%(n+f)!=0;)l=getRandomInt(1,50),w=getRandomInt(1,50);answer=solve(n+f,c,l,w)}drawEasyEquation(n,i,s,c,l,w,d,f)}possibleAnswers[0]=answer,fillWrongAnswers()}function lcm(s,t){return s&&t?Math.abs(s*t/gcd(s,t)):0}function gcd(s,t){for(s=Math.abs(s),t=Math.abs(t);t;){var e=t;t=s%t,s=e}return s}function fillWrongAnswers(){var s;if(possibleAnswers[0]<0){s=getRandomInt(1,20),possibleAnswers[1]=-1*(s+answer);var t=possibleAnswers[0].toString();t=t.length,2==t?s=getRandomInt(1,10):3==t&&(s=getRandomInt(10,50)),s*=-1,possibleAnswers[2]=s,s=getRandomInt(1,10),possibleAnswers[3]=-1*(s+answer)}else{s=getRandomInt(1,20),possibleAnswers[1]=s+answer;var t=possibleAnswers[0].toString();t=t.length,1==t?s=getRandomInt(1,9):2==t?s=getRandomInt(10,99):3==t&&(s=getRandomInt(100,500)),possibleAnswers[2]=s,s=getRandomInt(1,10),possibleAnswers[3]=s+answer}}function getRandomInt(s,t){return Math.floor(Math.random()*(t-s+1))+s}function random_character(){var s="abcdefghijkmnpqurstuvwxyzABCDEFGHJKLMNPQURSTUVWXYZ";return s.substr(Math.floor(48*Math.random()),1)}var canvas=document.getElementById("function"),ctx=canvas.getContext("2d"),maze=document.getElementById("maze"),ctx2=maze.getContext("2d"),WIDTH=600,HEIGHT=600,maze_type,src,last_src="_",img=new Image;img.crossOrigin="anonymous";var dx=50,dy=50,player_x=0,player_y=0,player_score=0,XanswerCoords=[],YanswerCoords=[],answer1status=0,answer2status=0,answer3status=0,answer4status=0,collision=0,hit_Miss=[0,0],answer,possibleAnswers=[1,2,3,4],possAnswer1,possAnswer2,possAnswer3,possAnswer4,lastQuestionType=-1,algebraQuestion=[0,"","",0,"=",0],visHitMiss=new test;visHitMiss.structure("array").location("#hit_missDiv").data(hit_Miss).visualize(),init(),window.addEventListener("keydown",doKeyDown,!0);